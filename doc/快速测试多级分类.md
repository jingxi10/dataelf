# 快速测试多级分类系统

## 测试前准备

### 1. 启动服务
```bash
# 启动后端
cd backend
mvn spring-boot:run

# 启动前端
cd frontend
npm run dev
```

### 2. 登录管理员账号
- 访问: http://localhost:3000/login
- 使用管理员账号登录

---

## 测试步骤

### 测试1: 访问分类管理页面

1. 登录后进入管理后台
2. 点击左侧菜单"分类管理"
3. **预期结果**: 
   - 显示分类管理页面
   - 看到"创建根分类"按钮
   - 看到"展开全部/收起全部"开关

---

### 测试2: 创建根分类（第1级）

1. 点击"创建根分类"按钮
2. 填写信息:
   - 分类名称: "科技产品"
   - 描述: "科技类产品分类"
   - 排序: 0
3. 点击"创建"
4. **预期结果**:
   - 提示"分类创建成功"
   - 分类树中显示新创建的分类
   - 分类前显示文件夹图标

---

### 测试3: 创建二级分类

1. 悬停在"科技产品"分类上
2. 点击"+"按钮
3. 填写信息:
   - 分类名称: "智能手机"
   - 描述: "智能手机相关内容"
   - 排序: 0
4. 点击"创建"
5. **预期结果**:
   - 提示"分类创建成功"
   - "科技产品"下显示"智能手机"子分类
   - 子分类前显示打开文件夹图标

---

### 测试4: 创建三级分类

1. 悬停在"智能手机"分类上
2. 点击"+"按钮
3. 填写信息:
   - 分类名称: "iPhone系列"
   - 描述: "苹果iPhone手机"
   - 排序: 0
4. 点击"创建"
5. **预期结果**:
   - 提示"分类创建成功"
   - "智能手机"下显示"iPhone系列"子分类
   - 三级分类前显示文档图标

---

### 测试5: 验证层级限制

1. 悬停在"iPhone系列"（第3级）分类上
2. **预期结果**:
   - 不显示"+"按钮
   - 无法添加子分类（已达到最大层级）

---

### 测试6: 查看分类详情

1. 点击任意分类节点
2. **预期结果**:
   - 右侧打开详情抽屉
   - 显示分类信息:
     - 分类名称
     - 层级（第X级）
     - 排序
     - 内容数量
     - 子分类数量
     - 创建时间
     - 描述

---

### 测试7: 编辑分类

1. 在详情抽屉中点击"编辑"按钮
2. 修改信息:
   - 分类名称: "科技产品（更新）"
   - 描述: "更新后的描述"
3. 点击"更新"
4. **预期结果**:
   - 提示"分类更新成功"
   - 分类树中显示更新后的名称
   - 层级不能修改（显示为只读）

---

### 测试8: 展开/收起功能

1. 创建多个分类和子分类
2. 点击"展开全部"开关
3. **预期结果**:
   - 所有分类节点展开
4. 再次点击开关
5. **预期结果**:
   - 所有分类节点收起

---

### 测试9: 删除叶子节点

1. 选择一个没有子分类的分类（如"iPhone系列"）
2. 点击"删除"按钮
3. 确认删除
4. **预期结果**:
   - 提示"分类删除成功"
   - 分类从树中移除

---

### 测试10: 删除有子分类的分类

1. 重新创建"智能手机"和"iPhone系列"
2. 选择"智能手机"分类
3. 点击"删除"按钮
4. 确认删除
5. **预期结果**:
   - 提示"分类删除成功"
   - "智能手机"及其所有子分类（包括"iPhone系列"）都被删除

---

### 测试11: 排序功能

1. 创建多个同级分类:
   - "科技产品" (排序: 0)
   - "生活用品" (排序: 1)
   - "食品饮料" (排序: 2)
2. **预期结果**:
   - 分类按排序值从小到大显示
3. 编辑"食品饮料"，将排序改为 -1
4. **预期结果**:
   - "食品饮料"移到最前面

---

### 测试12: 刷新功能

1. 点击"刷新"按钮
2. **预期结果**:
   - 重新加载分类树
   - 显示最新的分类数据

---

### 测试13: 表单验证

#### 测试空名称
1. 点击"创建根分类"
2. 不填写名称，直接点击"创建"
3. **预期结果**: 提示"请输入分类名称"

#### 测试名称长度
1. 输入1个字符的名称
2. **预期结果**: 提示"长度在 2 到 50 个字符"

#### 测试描述长度
1. 输入超过200字符的描述
2. **预期结果**: 自动限制在200字符

---

### 测试14: API接口测试

#### 公开接口（无需认证）
```bash
# 获取分类树
curl http://localhost:8080/api/public/categories/tree

# 获取指定分类
curl http://localhost:8080/api/public/categories/1

# 获取子分类
curl http://localhost:8080/api/public/categories/1/children
```

#### 管理接口（需要管理员Token）
```bash
# 创建分类
curl -X POST http://localhost:8080/api/admin/categories \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "测试分类",
    "description": "测试描述",
    "parentId": null,
    "sortOrder": 0
  }'

# 更新分类
curl -X PUT http://localhost:8080/api/admin/categories/1 \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "更新后的名称",
    "description": "更新后的描述",
    "sortOrder": 1
  }'

# 删除分类
curl -X DELETE http://localhost:8080/api/admin/categories/1 \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

## 测试场景

### 场景1: 完整的分类树
创建以下结构:
```
科技产品 (1级)
├── 智能手机 (2级)
│   ├── iPhone系列 (3级)
│   └── Android系列 (3级)
├── 笔记本电脑 (2级)
│   ├── MacBook (3级)
│   └── Windows笔记本 (3级)
└── 智能家居 (2级)
    ├── 智能音箱 (3级)
    └── 智能灯具 (3级)

生活用品 (1级)
├── 厨房用品 (2级)
└── 清洁用品 (2级)
```

### 场景2: 批量操作
1. 创建10个根分类
2. 为每个根分类创建3个子分类
3. 为部分子分类创建三级分类
4. 测试展开/收起性能
5. 测试删除性能

---

## 常见问题

### Q1: 为什么第3级分类没有"+"按钮？
**A**: 系统限制最多3级分类，第3级分类不能再添加子分类。

### Q2: 删除分类时提示"该分类下有内容"？
**A**: 需要先删除或移动该分类下的所有内容，才能删除分类。

### Q3: 编辑分类时为什么不能修改层级？
**A**: 层级由父分类自动决定，不能手动修改。如需调整层级，需要重新创建分类。

### Q4: 分类树加载很慢？
**A**: 检查数据库连接和索引。建议为 `parent_id` 和 `level` 字段添加索引。

---

## 性能测试

### 测试数据量
- 100个根分类
- 每个根分类10个子分类
- 部分子分类有三级分类
- 总计约1500个分类

### 性能指标
- 分类树加载时间: < 500ms
- 创建分类响应时间: < 200ms
- 更新分类响应时间: < 200ms
- 删除分类响应时间: < 300ms

---

## 测试检查清单

- [ ] 创建根分类
- [ ] 创建二级分类
- [ ] 创建三级分类
- [ ] 验证层级限制（第3级不能添加子分类）
- [ ] 查看分类详情
- [ ] 编辑分类信息
- [ ] 删除叶子节点
- [ ] 删除有子分类的分类（级联删除）
- [ ] 测试排序功能
- [ ] 测试展开/收起功能
- [ ] 测试刷新功能
- [ ] 测试表单验证
- [ ] 测试API接口
- [ ] 测试权限控制（非管理员不能访问）
- [ ] 测试响应式布局（移动端）

---

## 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 创建根分类 | ⏳ 待测试 | |
| 创建子分类 | ⏳ 待测试 | |
| 层级限制 | ⏳ 待测试 | |
| 编辑分类 | ⏳ 待测试 | |
| 删除分类 | ⏳ 待测试 | |
| 级联删除 | ⏳ 待测试 | |
| 排序功能 | ⏳ 待测试 | |
| 展开/收起 | ⏳ 待测试 | |
| 表单验证 | ⏳ 待测试 | |
| API接口 | ⏳ 待测试 | |
| 权限控制 | ⏳ 待测试 | |
| 响应式布局 | ⏳ 待测试 | |

---

## 下一步

测试完成后：
1. 记录发现的问题
2. 提交bug报告
3. 验证修复
4. 进行回归测试
5. 准备上线

---

**测试负责人**: ___________  
**测试日期**: ___________  
**测试环境**: 开发环境  
**测试状态**: ⏳ 待测试
